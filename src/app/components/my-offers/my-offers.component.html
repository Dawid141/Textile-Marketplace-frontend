<div class="min-h-full max-w-7xl mx-auto border-x flex">
  <!-- Side Panel -->
  <mat-sidenav-container class="w-72">
    <mat-sidenav mode="side" opened class="!bg-gray-100">
      <app-status-filter (showStatus)="onStatusFilterChange($event)"></app-status-filter>
    </mat-sidenav>
    <mat-sidenav-content></mat-sidenav-content>
  </mat-sidenav-container>

  <!-- Main Content -->
  <mat-card class="w-full mx-auto min-h-full mt-2" *ngIf="filteredData.length">
    <div *ngFor="let group of filteredData">
      <div class="border-1 p-4 mb-4 border-black rounded-lg shadow-md">
        <table mat-table [dataSource]="group.items" class="mat-elevation-z8 w-full">
          <!-- Product Image Column -->
          <ng-container matColumnDef="productImage">
            <th mat-header-cell *matHeaderCellDef class="text-center">Product</th>
            <td mat-cell *matCellDef="let element">
              <img src="{{ element.productImage || 'http://via.placeholder.com/150' }}"
                   alt="productImage"
                   class="w-[100px] my-3 ml-2" />
            </td>
          </ng-container>

          <!-- Listing Name Column -->
          <ng-container matColumnDef="listingName">
            <th mat-header-cell *matHeaderCellDef>Name</th>
            <td mat-cell *matCellDef="let element">
              <button mat-button
                      [routerLink]="'/single-offer/' + element.listingId"
                      matTooltip="{{ element.listingName }}">
                <p class="truncate max-w-16 block">
                  {{ element.listingName }}
                </p>
              </button>
            </td>
          </ng-container>

          <!-- Listing Quantity Column -->
          <ng-container matColumnDef="listingQuantity">
            <th mat-header-cell *matHeaderCellDef>Listing Quantity</th>
            <td
              mat-cell
              *matCellDef="let element"
              class="text-center"
              [ngClass]="{
      'text-green-500': element.listingQuantity > 0,
      'text-red-500': element.listingQuantity === 0
    }"
            >
              <ng-container *ngIf="element.listingQuantity > 0">
                {{ element.listingQuantity }}
              </ng-container>
              <ng-container *ngIf="element.listingQuantity === 0">
                OUT OF STOCK
              </ng-container>
            </td>
          </ng-container>

          <!-- Old Price Column -->
          <ng-container matColumnDef="oldOrderPrice">
            <th mat-header-cell *matHeaderCellDef>Old Price</th>
            <td mat-cell *matCellDef="let element">
              {{ element.oldOrderPrice | currency }}
            </td>
          </ng-container>

          <!-- Ordered Quantity Column -->
          <ng-container matColumnDef="orderQuantity">
            <th mat-header-cell *matHeaderCellDef>Ordered Quantity</th>
            <td mat-cell *matCellDef="let element" class="text-center">
              {{ element.orderQuantity }}
            </td>
          </ng-container>

          <!-- New Price Column -->
          <ng-container matColumnDef="newOrderPrice">
            <th mat-header-cell *matHeaderCellDef>New Price</th>
            <td mat-cell *matCellDef="let element">
              {{ element.newOrderPrice | currency }}
            </td>
          </ng-container>

          <!-- Order Status Column -->
          <ng-container matColumnDef="orderStatus">
            <th mat-header-cell *matHeaderCellDef>Status</th>
            <td mat-cell *matCellDef="let element"
                [ngClass]="getStatusClass(element.orderStatus)">
              {{ element.orderStatus }}
            </td>
          </ng-container>

          <!-- Action Buttons Column -->
          <ng-container matColumnDef="Action">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let element" class="align-middle space-x-1">
              <button mat-mini-fab
                      [ngClass]="{
              '!bg-green-500 text-white': !(element.orderStatus === 'REJECTED' || element.orderStatus === 'ACCEPTED' || element.orderQuantity === 0),
              '!bg-gray-400 text-gray-200': element.orderStatus === 'REJECTED' || element.orderStatus === 'ACCEPTED' || element.orderQuantity === 0
            }"
                      [disabled]="element.orderStatus === 'REJECTED' || element.orderStatus === 'ACCEPTED' || element.orderQuantity === 0"
                      (click)="acceptOrder(element.id)">
                <mat-icon>check</mat-icon>
              </button>

              <button mat-mini-fab
                      [ngClass]="{
              '!bg-red-500 text-white': !(element.orderStatus === 'REJECTED' || element.orderStatus === 'ACCEPTED' || element.orderQuantity === 0),
              '!bg-gray-400 text-gray-200': element.orderStatus === 'REJECTED' || element.orderStatus === 'ACCEPTED' || element.orderQuantity === 0
            }"
                      [disabled]="element.orderStatus === 'REJECTED' || element.orderStatus === 'ACCEPTED' || element.orderQuantity === 0"
                      (click)="rejectOrder(element.id)">
                <mat-icon>close</mat-icon>
              </button>

              <button mat-mini-fab
                      [ngClass]="{
              '!bg-blue-500 text-white': !(element.orderStatus === 'REJECTED' || element.orderStatus === 'ACCEPTED' || element.orderStatus === 'NEGOTIATION' || element.orderQuantity === 0),
              '!bg-gray-300 text-gray-500': element.orderStatus === 'NEGOTIATION' || element.orderQuantity === 0,
              '!bg-gray-400 text-gray-200': element.orderStatus === 'REJECTED' || element.orderStatus === 'ACCEPTED' || element.orderQuantity === 0
            }"
                      [disabled]="element.orderStatus === 'REJECTED' || element.orderStatus === 'ACCEPTED' || element.orderStatus === 'NEGOTIATION' || element.orderQuantity === 0">
                <mat-icon>chat</mat-icon>
              </button>
            </td>
          </ng-container>

          <!-- Table Rows -->
          <tr mat-header-row *matHeaderRowDef="displayColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayColumns"></tr>
        </table>
      </div>
    </div>
  </mat-card>

  <!-- Fallback for No Data -->
  <mat-card class="w-full mx-auto items-center p-1 min-h-full" *ngIf="!filteredData.length">
    <div class="mt-96">
      <a class="mx-10">You don't have any offers created</a>
      <button class="mx-10" mat-raised-button routerLink="/products">Create offer</button>
    </div>
  </mat-card>
</div>

<!-- Footer -->
<footer class="bg-gray-200 text-center py-4 border-t max-w-10xl mx-auto">
  <p class="text-sm text-gray-600">
    Â© 2025 Your Company. All rights reserved.
  </p>
</footer>
